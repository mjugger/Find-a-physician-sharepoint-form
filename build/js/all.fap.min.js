!function(e){"use strict";function t(t){var a,r,i,o,s,n="",l=null,c=t.Obj.data("SPCascadeDropdownsChildColumns");e(c).each(function(){var c=this.opt,d=this.childSelect,m=this.childColumnStatic,u=this.childColumnRequired;a=N(t,c.matchOnId);var p=a.join(X);if(t.Obj.data("SPCascadeDropdown_Selected_"+m)!==p){t.Obj.data("SPCascadeDropdown_Selected_"+m,p),l=N(d,!0);var h=c.relationshipListSortColumn.length>0?c.relationshipListSortColumn:c.relationshipListChildColumn,f="<Query><OrderBy><FieldRef Name='"+h+"'/></OrderBy><Where><And>";if(c.CAMLQuery.length>0&&(f+="<And>"),0===a.length)f+="<Eq><FieldRef Name='"+c.relationshipListParentColumn+"'/><Value Type='Text'></Value></Eq>";else if(1===a.length)f+="<Eq><FieldRef Name='"+c.relationshipListParentColumn+(c.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+M(a[0])+"</Value></Eq>";else{var b=a.length>2;for(Ce=0;Ce<a.length-1;Ce++)f+="<Or>";for(Ce=0;Ce<a.length;Ce++)f+="<Eq><FieldRef Name='"+c.relationshipListParentColumn+(c.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+M(a[Ce])+"</Value></Eq>",Ce>0&&Ce<a.length-1&&b&&(f+="</Or>");f+="</Or>"}c.CAMLQuery.length>0&&(f+=c.CAMLQuery+"</And>"),f+="<IsNotNull><FieldRef Name='"+c.relationshipListChildColumn+"' /></IsNotNull>",f+="</And></Where></Query>",e().SPServices({operation:"GetListItems",async:!1,webURL:c.relationshipWebURL,listName:c.relationshipList,CAMLQuery:f,CAMLViewFields:"<ViewFields><FieldRef Name='"+c.relationshipListParentColumn+"' /><FieldRef Name='"+c.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:c.CAMLQueryOptions,completefunc:function(t){switch(e(t.responseXML).find("errorstring").each(function(){var t="SPServices.SPCascadeDropdowns",a=e(this).text();c.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===a?w(t,"relationshipListParentColumn: "+c.relationshipListParentColumn+" or relationshipListChildColumn: "+c.relationshipListChildColumn,"Not found in relationshipList "+c.relationshipList):c.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===a&&w(t,"relationshipList: "+c.relationshipList,"List not found")}),d.Type){case H.simple:e(d.Obj).find("option").remove(),!u&&c.promptText.length>0?d.Obj.append("<option value='0'>"+c.promptText.replace(/\{0\}/g,c.childColumn)+"</option>"):u||d.Obj.append("<option value='0'>"+c.noneText+"</option>");break;case H.complex:n=u?"":c.noneText+"|0",d.Obj.val("");break;case H.multiSelect:e(d.master.candidateControl).find("option").remove(),r=""}switch(i=parseFloat(e(t.responseXML).SPFilterNode("rs:data").attr("ItemCount")),e(t.responseXML).SPFilterNode("z:row").each(function(){var t={},a=e(this).attr("ows_"+c.relationshipListChildColumn);switch("undefined"!=typeof a&&a.indexOf(X)>0?t=new V(a):(t.id=e(this).attr("ows_ID"),t.value=a),isNaN(t.id)&&(t.id=e(this).attr("ows_ID")),o=t.id,s=t.value,d.Type){case H.simple:var i=e(this).attr("ows_ID")===l[0]?" selected='selected'":"";d.Obj.append("<option"+i+" value='"+t.id+"'>"+t.value+"</option>");break;case H.complex:t.id===l[0]&&d.Obj.val(t.value),n=n+(n.length>0?"|":"")+t.value+"|"+t.id;break;case H.multiSelect:e(d.master.candidateControl).append("<option value='"+t.id+"'>"+t.value+"</option>"),r+=t.id+"|t"+t.value+"|t |t |t"}}),d.Type){case H.simple:d.Obj.trigger("change"),1===i&&c.selectSingleOption===!0&&e(d.Obj).find("option[value!='0']:first").attr("selected","selected");break;case H.complex:d.Obj.attr("choices",n),1===i&&c.selectSingleOption===!0&&(e(d.Obj).val(s),d.optHid.val(o)),""===d.Obj.val()&&d.optHid.val("");break;case H.multiSelect:d.master.data="",d.MultiLookupPickerdata.val(r),e(d.master.resultControl).find("option").each(function(){var t=e(this);t.prop("selected",!0),e(d.master.candidateControl).find("option[value='"+t.val()+"']").each(function(){t.prop("selected",!1)})}),GipRemoveSelectedItems(d.master),e(d.master.candidateControl).find("option").each(function(){var t=e(this);e(d.master.resultControl).find("option[value='"+t.val()+"']").each(function(){t.remove()})}),GipAddSelectedItems(d.master),d.master.data=GipGetGroupData(r),e(d.master.candidateControl).trigger("dblclick")}}}),null!==c.completefunc&&c.completefunc()}})}function a(t,a,r,i){var o,s="SPServices.SPDisplayRelatedInfo",n=e().SPServices.SPDropdownCtl({displayName:t.columnName});if(o=N(n,t.matchOnId),!(n.Type===H.complex&&t.numChars>0&&o[0].length<t.numChars)&&n.Obj.attr("showRelatedSelected")!==o[0]){n.Obj.attr("showRelatedSelected",o[0]),e("#"+a).remove(),n.Obj.parent().append("<div id="+a+"></div>");var l="<Query><Where>";t.CAMLQuery.length>0&&(l+="<And>");var c=i[t.relatedListColumn].attr("Type");l+="Lookup"===c?"<Eq><FieldRef Name='"+t.relatedListColumn+(t.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+M(o[0])+"</Value></Eq>":"<Eq><FieldRef Name='"+(t.matchOnId?"ID' /><Value Type='Counter'>":t.relatedListColumn+"'/><Value Type='Text'>")+M(o[0])+"</Value></Eq>",t.CAMLQuery.length>0&&(l+=t.CAMLQuery+"</And>"),l+="</Where></Query>";var d=" ";for(Ce=0;Ce<t.relatedColumns.length;Ce++)d+="<FieldRef Name='"+t.relatedColumns[Ce]+"' />";e().SPServices({operation:"GetListItems",async:!1,webURL:t.relatedWebURL,listName:t.relatedList,CAMLQuery:l,CAMLViewFields:"<ViewFields>"+d+"</ViewFields>",CAMLRowLimit:0,completefunc:function(o){e(o.responseXML).find("errorstring").each(function(){var a=e(this).text();t.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===a?w(s,"relatedListColumn: "+t.relatedListColumn,"Column not found in relatedList "+t.relatedList):t.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===a&&w(s,"relatedList: "+t.relatedList,"List not found")});var n;switch(t.displayFormat){case"table":for(n="<table>",n+="<tr>",Ce=0;Ce<t.relatedColumns.length;Ce++){if("undefined"==typeof i[t.relatedColumns[Ce]]&&t.debug)return void w(s,"columnName: "+t.relatedColumns[Ce],"Column not found in relatedList");n+="<th class='"+t.headerCSSClass+"'>"+i[t.relatedColumns[Ce]].attr("DisplayName")+"</th>"}n+="</tr>",e(o.responseXML).SPFilterNode("z:row").each(function(){for(n+="<tr>",Ce=0;Ce<t.relatedColumns.length;Ce++)n+="<td class='"+t.rowCSSClass+"'>"+C(r,i[t.relatedColumns[Ce]],e(this).attr("ows_"+t.relatedColumns[Ce]),t)+"</td>";n+="</tr>"}),n+="</table>";break;case"list":n="<table>",e(o.responseXML).SPFilterNode("z:row").each(function(){for(Ce=0;Ce<t.relatedColumns.length;Ce++){if("undefined"==typeof i[t.relatedColumns[Ce]]&&t.debug)return void w(s,"columnName: "+t.relatedColumns[Ce],"Column not found in relatedList");n+="<tr>",n+="<th class='"+t.headerCSSClass+"'>"+i[t.relatedColumns[Ce]].attr("DisplayName")+"</th>",n+="<td class='"+t.rowCSSClass+"'>"+C(r,i[t.relatedColumns[Ce]],e(this).attr("ows_"+t.relatedColumns[Ce]),t)+"</td>",n+="</tr>"}}),n+="</table>"}e("#"+a).html(n)}}),null!==t.completefunc&&t.completefunc()}}function r(t,a,r,s,n){var l=0,c=0,d={};d.type=[],d.src=[],d.script=[];var m=RegExp("<script[\\s\\S]*?/script>","gi");e.ajax({type:"GET",url:n,dataType:"text",async:!1,success:function(u){for(var p;p=m.exec(u);){var h=i(p,"language"),f=i(p,"type"),b=i(p,"src");null!==b&&b.length>0&&!o(b)&&(d.type.push(null!==h&&h.length>0?h:f),d.src.push(b),c++)}if(!t.showNoScript&&d.type.length>0||t.showNoScript){var S=n.substring(0,n.lastIndexOf(j)+1),g="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+a.attr("DefaultViewUrl")+"'><IMG border=0 src='"+a.attr("ImageUrl")+"'width=16 height=16></A></TD><td class=ms-vb2><a href='"+a.attr("DefaultViewUrl")+"'>"+a.attr("Title")+("True"===a.attr("Hidden")?"(Hidden)":"")+"</td><td class=ms-vb2>"+r+"</td><td class=ms-vb2>"+s+"</td><td class=ms-vb2><a href='"+n+"'>"+A(n)+"</td>";if(t.showSrc){var v;for(g+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>",l=0;l<d.type.length;l++)v=d.src[l].substr(0,1)!==j?S+d.src[l]:d.src[l],g+="<tr><td class=ms-vb2 width='30%'>"+d.type[l]+"</td>",g+="<td class=ms-vb2 width='70%'><a href='"+v+"'>"+A(d.src[l])+"</td></tr>";g+="</table></td>"}e("#SPScriptAudit").append(g)}}})}function i(e,t){var a,r=RegExp(t+"=(\"([^\"]*)\")|('([^']*)')","gi");return(a=r.exec(e))?a[2]:null}function o(e){var t,a=["WebResource.axd","_layouts"];for(t=0;t<a.length;t++)if(e.indexOf(a[t])>-1)return!0;return!1}function s(e,t){var a;switch(t){case"Text":a=e;break;case"DateTime":case"datetime":a=d(e);break;case"User":a=m(e);break;case"UserMulti":a=u(e);break;case"Lookup":a=p(e);break;case"LookupMulti":a=h(e);break;case"Boolean":a=c(e);break;case"Integer":a=n(e);break;case"Counter":a=n(e);break;case"MultiChoice":a=f(e);break;case"Number":case"Currency":case"float":a=l(e);break;case"Calculated":a=g(e);break;case"Attachments":a=b(e);break;case"URL":a=S(e);break;case"JSON":a=v(e);break;default:a=e}return a}function n(e){return parseInt(e,10)}function l(e){return parseFloat(e)}function c(e){return"0"!==e}function d(e){var t=e.split(e.split("T")[0]!==e?"T":" "),a=t[0].split("-"),r=t[1].split(":"),i=r[2].split("Z");return new Date(a[0],a[1]-1,a[2],r[0],r[1],i[0])}function m(e){if(0===e.length)return null;var t=new V(e),a=t.value.split(",#");return 1===a.length?{userId:t.id,userName:t.value}:{userId:t.id,userName:a[0].replace(/(,,)/g,","),loginName:a[1].replace(/(,,)/g,","),email:a[2].replace(/(,,)/g,","),sipAddress:a[3].replace(/(,,)/g,","),title:a[4].replace(/(,,)/g,",")}}function u(e){if(0===e.length)return null;var t=[],a=e.split(X);for(Ce=0;Ce<a.length;Ce+=2){var r=m(a[Ce]+X+a[Ce+1]);t.push(r)}return t}function p(e){if(0===e.length)return null;var t=e.split(X);return{lookupId:t[0],lookupValue:t[1]}}function h(e){if(0===e.length)return null;var t=[],a=e.split(X);for(Ce=0;Ce<a.length;Ce+=2){var r=p(a[Ce]+X+a[Ce+1]);t.push(r)}return t}function f(e){if(0===e.length)return null;var t=[],a=e.split(X);for(Ce=0;Ce<a.length;Ce++)0!==a[Ce].length&&t.push(a[Ce]);return t}function b(e){if(0===e.length)return null;if("0"===e||"1"===e)return e;var t=[],a=e.split(X);for(Ce=0;Ce<a.length;Ce++)if(0!==a[Ce].length){var r=a[Ce];if(-1!==a[Ce].lastIndexOf("/")){var i=a[Ce].split("/");r=i[i.length-1]}t.push({attachment:a[Ce],fileName:r})}return t}function S(e){if(0===e.length)return null;var t=e.split(", ");return{Url:t[0],Description:t[1]}}function g(e){if(0===e.length)return null;var t=e.split(X);return s(t[1],t[0])}function v(t){return 0===t.length?null:e.parseJSON(t)}function y(){var e=location.protocol+"//"+location.host+(""!==location.port?location.port:"");"undefined"!=typeof _spPageContextInfo?(this.thisSite=e+_spPageContextInfo.webServerRelativeUrl,this.thisList=_spPageContextInfo.pageListId,this.thisUserId=_spPageContextInfo.userId):(this.thisSite="undefined"!=typeof L_Menu_BaseUrl?e+L_Menu_BaseUrl:"",this.thisList="",this.thisUserId="undefined"!=typeof _spUserId?_spUserId:void 0)}function C(t,a,r,i){if("undefined"==typeof r)return"";var o,s,n,l="",c=[],d=i.relatedWebURL.length>0?i.relatedWebURL:e().SPServices.SPGetCurrentSite();switch(a.attr("Type")){case"Text":l=r;break;case"URL":switch(a.attr("Format")){case"Hyperlink":l="<a href='"+r.substring(0,r.search(","))+"'>"+r.substring(r.search(",")+1)+"</a>";break;case"Image":l="<img alt='"+r.substring(r.search(",")+1)+"' src='"+r.substring(0,r.search(","))+"'/>";break;default:l=r}break;case"User":case"UserMulti":var m=r.split(X);for(o=0;o<m.length;o+=2)c.push("<a href='/_layouts/userdisp.aspx?ID="+m[o]+"&Source="+O(location.href)+"'>"+m[o+1]+"</a>");l=c.join(", ");break;case"Calculated":var u=r.split(X);l=u[1];break;case"Number":n=a.attr("Decimals"),l="undefined"==typeof n?parseFloat(r).toString():parseFloat(r).toFixed(n).toString();break;case"Currency":n=a.attr("Decimals"),l="undefined"==typeof n?parseFloat(r).toFixed(2).toString():parseFloat(r).toFixed(n).toString();break;case"Lookup":switch(a.attr("Name")){case"FileRef":s="1"===t.attr("BaseType")?t.attr("RootFolder")+j+"Forms/DispForm.aspx":t.attr("RootFolder")+j+"DispForm.aspx",l="<a href='"+s+"?ID="+r.substring(0,r.search(X))+"&RootFolder=*&Source="+O(location.href)+"'>"+r.substring(r.search(X)+2)+"</a>";break;case"FileDirRef":s=j+r.substring(r.search(X)+2),l="<a href='"+s+"'>"+r.substring(r.search(X)+2)+"</a>";break;default:s=U(a.attr("List"),"DisplayForm"),l="<a href='"+i.relatedWebURL+j+s+"?ID="+r.substring(0,r.search(X))+"&RootFolder=*&Source="+O(location.href)+"'>"+r.substring(r.search(X)+2)+"</a>"}break;case"LookupMulti":if(s=U(a.attr("List"),"DisplayForm"),l="",r.length>0){var p=r.split(X);for(o=0;o<p.length/2;o++)c.push("<a href='"+d+j+s+"?ID="+p[2*o]+"&RootFolder=*&Source="+O(location.href)+"'>"+p[2*o+1]+"</a>")}l=c.join(", ");break;case"File":A=r.substring(r.search(X)+2),l="<a href='"+t.attr("RootFolder")+j+A+"'>"+A+"</a>";break;case"Counter":l=r;break;case"DateTime":l=r;break;default:l=r}return l}function L(e){var t,a="<table class='ms-vb' width='100%'>";for(t=0;t<e.attributes.length;t++)a+="<tr><td width='10px' style='font-weight:bold;'>"+t+"</td><td width='100px'>"+e.attributes.item(t).nodeName+"</td><td>"+I(e.attributes.item(t).nodeValue)+"</td></tr>";return a+="</table>"}function N(t,a){var r=[];switch(t.Type){case H.simple:r.push(a?t.Obj.find("option:selected").val()||[]:t.Obj.find("option:selected").text()||[]);break;case H.complex:r.push(a?t.optHid.val()||[]:t.Obj.val()||[]);break;case H.multiSelect:e(t.master.resultControl).find("option").each(function(){r.push(a?e(this).val():e(this).html())})}return r}function w(e,t,a){var r="<b>Error in function</b><br/>"+e+"<br/><b>Parameter</b><br/>"+t+"<br/><b>Message</b><br/>"+a+"<br/><br/><span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";k(r)}function k(t){var a="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";e("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+a+">"+t);var r=e("#SPServices_msgBox"),i=r.height(),o=r.width(),s=e(window).width()/2-o/2+"px",n=e(window).height()/2-i/2-100+"px";r.css({border:"5px #C02000 solid",left:s,top:n}).show().fadeTo("slow",.75).click(function(){e(this).fadeOut("3000",function(){e(this).remove()})})}function P(t,a,r){var i=void 0!==r?r:e().SPServices.SPListNameFromUrl();return t+"_"+e().SPServices.SPGetStaticFromDisplay({listName:i,columnDisplayName:a})}function U(t,a){var r;return e().SPServices({operation:"GetFormCollection",async:!1,listName:t,completefunc:function(t){r=e(t.responseXML).find("Form[Type='"+a+"']").attr("Url")}}),r}function x(t,a){var r;for(r=0;r<a.length;r++)"string"==typeof a[r]?we.payload+=R(a[r],t[a[r]]):e.isArray(a[r])&&2===a[r].length?we.payload+=R(a[r][0],t[a[r][1]]):"object"==typeof a[r]&&void 0!==a[r].sendNull?we.payload+=void 0===t[a[r].name]||0===t[a[r].name].length?"":R(a[r].name,t[a[r].name]):w(t.operation,"paramArray["+r+"]: "+a[r],"Invalid paramArray element passed to addToPayload()")}function G(t){var a,r=RegExp('FieldName="'+t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"',"gi");return e("td.ms-formbody, td.ms-formbodysurvey").each(function(){return r.test(e(this).html())?(a=e(this),!1):void 0}),a}function T(e,t){var a=t.substring(8);return e.opheader=e.opheader.replace(t,a),e.opfooter=e.opfooter.replace(t,a),e}function R(e,t){var a="undefined"!=typeof t?t:"";return"<"+e+">"+a+"</"+e+">"}function F(){return Math.round(Math.random())-.5}function I(e){return 0===e.indexOf("http")||0===e.indexOf(j)?"<a href='"+e+"'>"+e+"</a>":e}function A(e){return e.substring(e.lastIndexOf(j)+1,e.length)}function D(e){return e.replace(/([\&"<>])/g,function(e,t){return Pe[t]})}function M(e){return"string"==typeof e?e.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;"):e}function O(e){return e.replace(/&/g,"%26")}function V(e){var t=e.split(X);this.id=t[0],this.value=t[1]}function W(e){return 10>e?"0"+e:e}var Q="2014.02",j="/",X=";#",E="Column not found on page",_="http://schemas.microsoft.com/sharepoint",q="MultiLookupPicker",B="MultiLookup",H={simple:"S",complex:"C",multiSelect:"M"},z=["Integer","Text","Note","DateTime","Counter","Choice","Lookup","Boolean","Number","Currency","URL","MultiChoice","Calculated","File","Attachments","User","ModStat","ContentTypeId","WorkflowStatus","UserMulti","LookupMulti","datetime","float","Calc"],$={},K="Alerts",J="Authentication",Z="Copy",Y="Forms",ee="Lists",te="Meetings",ae="OfficialFile",re="People",ie="Permissions",oe="PublishedLinksService",se="Search",ne="SharePointDiagnostics",le="SiteData",ce="Sites",de="SocialDataService",me="SpellCheck",ue="TaxonomyClientService",pe="usergroup",he="UserProfileService",fe="Versions",be="Views",Se="WebPartPages",ge="Webs",ve="Workflow",ye=new y,Ce=0,Le=["listName","description"],Ne=[];Ne.GetAlerts=[K,!1],Ne.DeleteAlerts=[K,!0],Ne.Mode=[J,!1],Ne.Login=[J,!1],Ne.CopyIntoItems=[Z,!0],Ne.CopyIntoItemsLocal=[Z,!0],Ne.GetItem=[Z,!1],Ne.GetForm=[Y,!1],Ne.GetFormCollection=[Y,!1],Ne.AddAttachment=[ee,!0],Ne.AddDiscussionBoardItem=[ee,!0],Ne.AddList=[ee,!0],Ne.AddListFromFeature=[ee,!0],Ne.ApplyContentTypeToList=[ee,!0],Ne.CheckInFile=[ee,!0],Ne.CheckOutFile=[ee,!0],Ne.CreateContentType=[ee,!0],Ne.DeleteAttachment=[ee,!0],Ne.DeleteContentType=[ee,!0],Ne.DeleteContentTypeXmlDocument=[ee,!0],Ne.DeleteList=[ee,!0],Ne.GetAttachmentCollection=[ee,!1],Ne.GetList=[ee,!1],Ne.GetListAndView=[ee,!1],Ne.GetListCollection=[ee,!1],Ne.GetListContentType=[ee,!1],Ne.GetListContentTypes=[ee,!1],Ne.GetListItemChanges=[ee,!1],Ne.GetListItemChangesSinceToken=[ee,!1],Ne.GetListItems=[ee,!1],Ne.GetVersionCollection=[ee,!1],Ne.UndoCheckOut=[ee,!0],Ne.UpdateContentType=[ee,!0],Ne.UpdateContentTypesXmlDocument=[ee,!0],Ne.UpdateContentTypeXmlDocument=[ee,!0],Ne.UpdateList=[ee,!0],Ne.UpdateListItems=[ee,!0],Ne.AddMeeting=[te,!0],Ne.CreateWorkspace=[te,!0],Ne.RemoveMeeting=[te,!0],Ne.SetWorkSpaceTitle=[te,!0],Ne.GetRecordRouting=[ae,!1],Ne.GetRecordRoutingCollection=[ae,!1],Ne.GetServerInfo=[ae,!1],Ne.SubmitFile=[ae,!0],Ne.ResolvePrincipals=[re,!0],Ne.SearchPrincipals=[re,!1],Ne.AddPermission=[ie,!0],Ne.AddPermissionCollection=[ie,!0],Ne.GetPermissionCollection=[ie,!0],Ne.RemovePermission=[ie,!0],Ne.RemovePermissionCollection=[ie,!0],Ne.UpdatePermission=[ie,!0],Ne.GetLinks=[oe,!0],Ne.GetPortalSearchInfo=[se,!1],Ne.GetQuerySuggestions=[se,!1],Ne.GetSearchMetadata=[se,!1],Ne.Query=[se,!1],Ne.QueryEx=[se,!1],Ne.Registration=[se,!1],Ne.Status=[se,!1],Ne.SendClientScriptErrorReport=[ne,!0],Ne.GetAttachments=[le,!1],Ne.EnumerateFolder=[le,!1],Ne.SiteDataGetList=[le,!1],Ne.SiteDataGetListCollection=[le,!1],Ne.SiteDataGetSite=[le,!1],Ne.SiteDataGetSiteUrl=[le,!1],Ne.SiteDataGetWeb=[le,!1],Ne.CreateWeb=[ce,!0],Ne.DeleteWeb=[ce,!0],Ne.GetSite=[ce,!1],Ne.GetSiteTemplates=[ce,!1],Ne.AddComment=[de,!0],Ne.AddTag=[de,!0],Ne.AddTagByKeyword=[de,!0],Ne.CountCommentsOfUser=[de,!1],Ne.CountCommentsOfUserOnUrl=[de,!1],Ne.CountCommentsOnUrl=[de,!1],Ne.CountRatingsOnUrl=[de,!1],Ne.CountTagsOfUser=[de,!1],Ne.DeleteComment=[de,!0],Ne.DeleteRating=[de,!0],Ne.DeleteTag=[de,!0],Ne.DeleteTagByKeyword=[de,!0],Ne.DeleteTags=[de,!0],Ne.GetAllTagTerms=[de,!1],Ne.GetAllTagTermsForUrlFolder=[de,!1],Ne.GetAllTagUrls=[de,!1],Ne.GetAllTagUrlsByKeyword=[de,!1],Ne.GetCommentsOfUser=[de,!1],Ne.GetCommentsOfUserOnUrl=[de,!1],Ne.GetCommentsOnUrl=[de,!1],Ne.GetRatingAverageOnUrl=[de,!1],Ne.GetRatingOfUserOnUrl=[de,!1],Ne.GetRatingOnUrl=[de,!1],Ne.GetRatingsOfUser=[de,!1],Ne.GetRatingsOnUrl=[de,!1],Ne.GetSocialDataForFullReplication=[de,!1],Ne.GetTags=[de,!0],Ne.GetTagsOfUser=[de,!0],Ne.GetTagTerms=[de,!0],Ne.GetTagTermsOfUser=[de,!0],Ne.GetTagTermsOnUrl=[de,!0],Ne.GetTagUrlsOfUser=[de,!0],Ne.GetTagUrlsOfUserByKeyword=[de,!0],Ne.GetTagUrls=[de,!0],Ne.GetTagUrlsByKeyword=[de,!0],Ne.SetRating=[de,!0],Ne.UpdateComment=[de,!0],Ne.SpellCheck=[me,!1],Ne.AddTerms=[ue,!0],Ne.GetChildTermsInTerm=[ue,!1],Ne.GetChildTermsInTermSet=[ue,!1],Ne.GetKeywordTermsByGuids=[ue,!1],Ne.GetTermsByLabel=[ue,!1],Ne.GetTermSets=[ue,!1],Ne.AddGroup=[pe,!0],Ne.AddGroupToRole=[pe,!0],Ne.AddRole=[pe,!0],Ne.AddRoleDef=[pe,!0],Ne.AddUserCollectionToGroup=[pe,!0],Ne.AddUserCollectionToRole=[pe,!0],Ne.AddUserToGroup=[pe,!0],Ne.AddUserToRole=[pe,!0],Ne.GetAllUserCollectionFromWeb=[pe,!1],Ne.GetGroupCollection=[pe,!1],Ne.GetGroupCollectionFromRole=[pe,!1],Ne.GetGroupCollectionFromSite=[pe,!1],Ne.GetGroupCollectionFromUser=[pe,!1],Ne.GetGroupCollectionFromWeb=[pe,!1],Ne.GetGroupInfo=[pe,!1],Ne.GetRoleCollection=[pe,!1],Ne.GetRoleCollectionFromGroup=[pe,!1],Ne.GetRoleCollectionFromUser=[pe,!1],Ne.GetRoleCollectionFromWeb=[pe,!1],Ne.GetRoleInfo=[pe,!1],Ne.GetRolesAndPermissionsForCurrentUser=[pe,!1],Ne.GetRolesAndPermissionsForSite=[pe,!1],Ne.GetUserCollection=[pe,!1],Ne.GetUserCollectionFromGroup=[pe,!1],Ne.GetUserCollectionFromRole=[pe,!1],Ne.GetUserCollectionFromSite=[pe,!1],Ne.GetUserCollectionFromWeb=[pe,!1],Ne.GetUserInfo=[pe,!1],Ne.GetUserLoginFromEmail=[pe,!1],Ne.RemoveGroup=[pe,!0],Ne.RemoveGroupFromRole=[pe,!0],Ne.RemoveRole=[pe,!0],Ne.RemoveUserCollectionFromGroup=[pe,!0],Ne.RemoveUserCollectionFromRole=[pe,!0],Ne.RemoveUserCollectionFromSite=[pe,!0],Ne.RemoveUserFromGroup=[pe,!0],Ne.RemoveUserFromRole=[pe,!0],Ne.RemoveUserFromSite=[pe,!0],Ne.RemoveUserFromWeb=[pe,!0],Ne.UpdateGroupInfo=[pe,!0],Ne.UpdateRoleDefInfo=[pe,!0],Ne.UpdateRoleInfo=[pe,!0],Ne.UpdateUserInfo=[pe,!0],Ne.AddColleague=[he,!0],Ne.AddLink=[he,!0],Ne.AddMembership=[he,!0],Ne.AddPinnedLink=[he,!0],Ne.CreateMemberGroup=[he,!0],Ne.CreateUserProfileByAccountName=[he,!0],Ne.GetCommonColleagues=[he,!1],Ne.GetCommonManager=[he,!1],Ne.GetCommonMemberships=[he,!1],Ne.GetInCommon=[he,!1],Ne.GetPropertyChoiceList=[he,!1],Ne.GetUserColleagues=[he,!1],Ne.GetUserLinks=[he,!1],Ne.GetUserMemberships=[he,!1],Ne.GetUserPinnedLinks=[he,!1],Ne.GetUserProfileByGuid=[he,!1],Ne.GetUserProfileByIndex=[he,!1],Ne.GetUserProfileByName=[he,!1],Ne.GetUserProfileCount=[he,!1],Ne.GetUserProfileSchema=[he,!1],Ne.GetUserPropertyByAccountName=[he,!1],Ne.ModifyUserPropertyByAccountName=[he,!0],Ne.RemoveAllColleagues=[he,!0],Ne.RemoveAllLinks=[he,!0],Ne.RemoveAllMemberships=[he,!0],Ne.RemoveAllPinnedLinks=[he,!0],Ne.RemoveColleague=[he,!0],Ne.RemoveLink=[he,!0],Ne.RemoveMembership=[he,!0],Ne.RemovePinnedLink=[he,!0],Ne.UpdateColleaguePrivacy=[he,!0],Ne.UpdateLink=[he,!0],Ne.UpdateMembershipPrivacy=[he,!0],Ne.UpdatePinnedLink=[he,!0],Ne.DeleteAllVersions=[fe,!0],Ne.DeleteVersion=[fe,!0],Ne.GetVersions=[fe,!1],Ne.RestoreVersion=[fe,!0],Ne.AddView=[be,!0],Ne.DeleteView=[be,!0],Ne.GetView=[be,!1],Ne.GetViewHtml=[be,!1],Ne.GetViewCollection=[be,!1],Ne.UpdateView=[be,!0],Ne.UpdateViewHtml=[be,!0],Ne.AddWebPart=[Se,!0],Ne.AddWebPartToZone=[Se,!0],Ne.DeleteWebPart=[Se,!0],Ne.GetWebPart2=[Se,!1],Ne.GetWebPartPage=[Se,!1],Ne.GetWebPartProperties=[Se,!1],Ne.GetWebPartProperties2=[Se,!1],Ne.SaveWebPart2=[Se,!0],Ne.CreateContentType=[ge,!0],Ne.GetColumns=[ge,!1],Ne.GetContentType=[ge,!1],Ne.GetContentTypes=[ge,!1],Ne.GetCustomizedPageStatus=[ge,!1],Ne.GetListTemplates=[ge,!1],Ne.GetObjectIdFromUrl=[ge,!1],Ne.GetWeb=[ge,!1],Ne.GetWebCollection=[ge,!1],Ne.GetAllSubWebCollection=[ge,!1],Ne.UpdateColumns=[ge,!0],Ne.UpdateContentType=[ge,!0],Ne.WebUrlFromPageUrl=[ge,!1],Ne.AlterToDo=[ve,!0],Ne.ClaimReleaseTask=[ve,!0],Ne.GetTemplatesForItem=[ve,!1],Ne.GetToDosForItem=[ve,!1],Ne.GetWorkflowDataForItem=[ve,!1],Ne.GetWorkflowTaskData=[ve,!1],Ne.StartWorkflow=[ve,!0];var we={};we.header="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>",we.footer="</soap:Body></soap:Envelope>",we.payload="";var ke;e.fn.SPServices=function(t){for(var a=e.extend({},e.fn.SPServices.defaults,t),r=0;r<Le.length;r++)"string"==typeof a[Le[r]]&&(a[Le[r]]=D(a[Le[r]]));switch(we.opheader="<"+a.operation+" ",Ne[a.operation][0]){case K:we.opheader+="xmlns='"+_+"/soap/2002/1/alerts/' >",ke=_+"/soap/2002/1/alerts/";break;case te:we.opheader+="xmlns='"+_+"/soap/meetings/' >",ke=_+"/soap/meetings/";break;case ae:we.opheader+="xmlns='"+_+"/soap/recordsrepository/' >",ke=_+"/soap/recordsrepository/";break;case ie:we.opheader+="xmlns='"+_+"/soap/directory/' >",ke=_+"/soap/directory/";break;case oe:we.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >",ke="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case se:we.opheader+="xmlns='urn:Microsoft.Search' >",ke="urn:Microsoft.Search/";break;case ne:we.opheader+="xmlns='"+_+"/diagnostics/' >",ke="http://schemas.microsoft.com/sharepoint/diagnostics/";break;case de:we.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >",ke="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case me:we.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/' >",ke="http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck";break;case ue:we.opheader+="xmlns='"+_+"/taxonomy/soap/' >",ke=_+"/taxonomy/soap/";break;case pe:we.opheader+="xmlns='"+_+"/soap/directory/' >",ke=_+"/soap/directory/";break;case he:we.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >",ke="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case Se:we.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >",ke="http://microsoft.com/sharepoint/webpartpages/";break;case ve:we.opheader+="xmlns='"+_+"/soap/workflow/' >",ke=_+"/soap/workflow/";break;default:we.opheader+="xmlns='"+_+"/soap/'>",ke=_+"/soap/"}ke+=a.operation,we.opfooter="</"+a.operation+">";var i="_vti_bin/"+Ne[a.operation][0]+".asmx",o=e().SPServices.SPGetCurrentSite(),s=void 0!==a.webURL?a.webURL:a.webUrl;switch(i=s.charAt(s.length-1)===j?s+i:s.length>0?s+j+i:o+(o.charAt(o.length-1)===j?i:j+i),we.payload="",a.operation){case"GetAlerts":break;case"DeleteAlerts":for(we.payload+="<IDs>",r=0;r<a.IDs.length;r++)we.payload+=R("string",a.IDs[r]);we.payload+="</IDs>";break;case"Mode":break;case"Login":x(a,["username","password"]);break;case"CopyIntoItems":for(x(a,["SourceUrl"]),we.payload+="<DestinationUrls>",r=0;r<a.DestinationUrls.length;r++)we.payload+=R("string",a.DestinationUrls[r]);we.payload+="</DestinationUrls>",x(a,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":for(x(a,["SourceUrl"]),we.payload+="<DestinationUrls>",r=0;r<a.DestinationUrls.length;r++)we.payload+=R("string",a.DestinationUrls[r]);we.payload+="</DestinationUrls>";break;case"GetItem":x(a,["Url","Fields","Stream"]);break;case"GetForm":x(a,["listName","formUrl"]);break;case"GetFormCollection":x(a,["listName"]);break;case"AddAttachment":x(a,["listName","listItemID","fileName","attachment"]);break;case"AddDiscussionBoardItem":x(a,["listName","message"]);break;case"AddList":x(a,["listName","description","templateID"]);break;case"AddListFromFeature":x(a,["listName","description","featureID","templateID"]);break;case"ApplyContentTypeToList":x(a,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":x(a,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":x(a,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":x(a,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":x(a,["listName","listItemID","url"]);break;case"DeleteContentType":x(a,["listName","contentTypeId"]);break;case"DeleteContentTypeXmlDocument":x(a,["listName","contentTypeId","documentUri"]);break;case"DeleteList":x(a,["listName"]);break;case"GetAttachmentCollection":x(a,["listName",["listItemID","ID"]]);break;case"GetList":x(a,["listName"]);break;case"GetListAndView":x(a,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":x(a,["listName","contentTypeId"]);break;case"GetListContentTypes":x(a,["listName"]);break;case"GetListItems":x(a,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":x(a,["listName","viewFields","since","contains"]);break;case"GetListItemChangesSinceToken":x(a,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],{name:"changeToken",sendNull:!1},{name:"contains",sendNull:!1}]);break;case"GetVersionCollection":x(a,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":x(a,["pageUrl"]);break;case"UpdateContentType":x(a,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateContentTypesXmlDocument":x(a,["listName","newDocument"]);break;case"UpdateContentTypeXmlDocument":x(a,["listName","contentTypeId","newDocument"]);break;case"UpdateList":x(a,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":if(x(a,["listName"]),"undefined"!=typeof a.updates&&a.updates.length>0)x(a,["updates"]);else{for(we.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+a.batchCmd+"'>",r=0;r<a.valuepairs.length;r++)we.payload+="<Field Name='"+a.valuepairs[r][0]+"'>"+M(a.valuepairs[r][1])+"</Field>";"New"!==a.batchCmd&&(we.payload+="<Field Name='ID'>"+a.ID+"</Field>"),we.payload+="</Method></Batch></updates>"}break;case"AddMeeting":x(a,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":x(a,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":x(a,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":x(a,["title"]);break;case"GetRecordRouting":x(a,["recordRouting"]);break;case"GetRecordRoutingCollection":break;case"GetServerInfo":break;case"SubmitFile":x(a,["fileToSubmit"],["properties"],["recordRouting"],["sourceUrl"],["userName"]);break;case"ResolvePrincipals":x(a,["principalKeys","principalType","addToUserInfoList"]);break;case"SearchPrincipals":x(a,["searchText","maxResults","principalType"]);break;case"AddPermission":x(a,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":x(a,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":x(a,["objectName","objectType"]);break;case"RemovePermission":x(a,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":x(a,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":x(a,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":we.opheader="<"+a.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",ke="http://microsoft.com/webservices/OfficeServer/QueryService/"+a.operation;break;case"GetQuerySuggestions":we.opheader="<"+a.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",ke="http://microsoft.com/webservices/OfficeServer/QueryService/"+a.operation,we.payload+=R("queryXml",D(a.queryXml));break;case"GetSearchMetadata":we.opheader="<"+a.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",ke="http://microsoft.com/webservices/OfficeServer/QueryService/"+a.operation;break;case"Query":we.payload+=R("queryXml",D(a.queryXml));break;case"QueryEx":we.opheader="<"+a.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",ke="http://microsoft.com/webservices/OfficeServer/QueryService/"+a.operation,we.payload+=R("queryXml",D(a.queryXml));break;case"Registration":we.payload+=R("registrationXml",D(a.registrationXml));break;case"Status":break;case"SendClientScriptErrorReport":x(a,["message","file","line","client","stack","team","originalFile"]);

break;case"EnumerateFolder":x(a,["strFolderUrl"]);break;case"GetAttachments":x(a,["strListName","strItemId"]);break;case"SiteDataGetList":x(a,["strListName"]),we=T(we,a.operation);break;case"SiteDataGetListCollection":we=T(we,a.operation);break;case"SiteDataGetSite":we=T(we,a.operation);break;case"SiteDataGetSiteUrl":x(a,["Url"]),we=T(we,a.operation);break;case"SiteDataGetWeb":we=T(we,a.operation);break;case"CreateWeb":x(a,["url","title","description","templateName","language","languageSpecified","locale","localeSpecified","collationLocale","collationLocaleSpecified","uniquePermissions","uniquePermissionsSpecified","anonymous","anonymousSpecified","presence","presenceSpecified"]);break;case"DeleteWeb":x(a,["url"]);break;case"GetSite":x(a,["SiteUrl"]);break;case"GetSiteTemplates":x(a,["LCID","TemplateList"]);break;case"AddComment":x(a,["url","comment","isHighPriority","title"]);break;case"AddTag":x(a,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":x(a,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":x(a,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":x(a,["userAccountName","url"]);break;case"CountCommentsOnUrl":x(a,["url"]);break;case"CountRatingsOnUrl":x(a,["url"]);break;case"CountTagsOfUser":x(a,["userAccountName"]);break;case"DeleteComment":x(a,["url","lastModifiedTime"]);break;case"DeleteRating":x(a,["url"]);break;case"DeleteTag":x(a,["url","termID"]);break;case"DeleteTagByKeyword":x(a,["url","keyword"]);break;case"DeleteTags":x(a,["url"]);break;case"GetAllTagTerms":x(a,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":x(a,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":x(a,["termID"]);break;case"GetAllTagUrlsByKeyword":x(a,["keyword"]);break;case"GetCommentsOfUser":x(a,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":x(a,["userAccountName","url"]);break;case"GetCommentsOnUrl":x(a,["url","maximumItemsToReturn","startIndex"]),"undefined"!=typeof a.excludeItemsTime&&a.excludeItemsTime.length>0&&(we.payload+=R("excludeItemsTime",a.excludeItemsTime));break;case"GetRatingAverageOnUrl":x(a,["url"]);break;case"GetRatingOfUserOnUrl":x(a,["userAccountName","url"]);break;case"GetRatingOnUrl":x(a,["url"]);break;case"GetRatingsOfUser":x(a,["userAccountName"]);break;case"GetRatingsOnUrl":x(a,["url"]);break;case"GetSocialDataForFullReplication":x(a,["userAccountName"]);break;case"GetTags":x(a,["url"]);break;case"GetTagsOfUser":x(a,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":x(a,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":x(a,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":x(a,["url","maximumItemsToReturn"]);break;case"GetTagUrls":x(a,["termID"]);break;case"GetTagUrlsByKeyword":x(a,["keyword"]);break;case"GetTagUrlsOfUser":x(a,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":x(a,["keyword","userAccountName"]);break;case"SetRating":x(a,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":x(a,["url","lastModifiedTime","comment","isHighPriority"]);break;case"SpellCheck":x(a,["chunksToSpell","declaredLanguage","useLad"]);break;case"AddTerms":x(a,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":x(a,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":x(a,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":x(a,["termIds","lcid"]);break;case"GetTermsByLabel":x(a,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":x(a,["sharedServiceIds","termSetIds","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":x(a,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":x(a,["groupName","roleName"]);break;case"AddRole":x(a,["roleName","description","permissionMask"]);break;case"AddRoleDef":x(a,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":x(a,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":x(a,["roleName","usersInfoXml"]);break;case"AddUserToGroup":x(a,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":x(a,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":x(a,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":x(a,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":x(a,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":x(a,["groupName"]);break;case"GetRoleCollection":x(a,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":x(a,["groupName"]);break;case"GetRoleCollectionFromUser":x(a,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":x(a,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":x(a,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":x(a,["groupName"]);break;case"GetUserCollectionFromRole":x(a,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":x(a,["userLoginName"]);break;case"GetUserLoginFromEmail":x(a,["emailXml"]);break;case"RemoveGroup":x(a,["groupName"]);break;case"RemoveGroupFromRole":x(a,["roleName","groupName"]);break;case"RemoveRole":x(a,["roleName"]);break;case"RemoveUserCollectionFromGroup":x(a,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":x(a,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":x(a,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":x(a,["groupName","userLoginName"]);break;case"RemoveUserFromRole":x(a,["roleName","userLoginName"]);break;case"RemoveUserFromSite":x(a,["userLoginName"]);break;case"RemoveUserFromWeb":x(a,["userLoginName"]);break;case"UpdateGroupInfo":x(a,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":x(a,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":x(a,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":x(a,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":x(a,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":x(a,["accountName","name","url","group","privacy"]);break;case"AddMembership":x(a,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":x(a,["accountName","name","url"]);break;case"CreateMemberGroup":x(a,["membershipInfo"]);break;case"CreateUserProfileByAccountName":x(a,["accountName"]);break;case"GetCommonColleagues":x(a,["accountName"]);break;case"GetCommonManager":x(a,["accountName"]);break;case"GetCommonMemberships":x(a,["accountName"]);break;case"GetInCommon":x(a,["accountName"]);break;case"GetPropertyChoiceList":x(a,["propertyName"]);break;case"GetUserColleagues":x(a,["accountName"]);break;case"GetUserLinks":x(a,["accountName"]);break;case"GetUserMemberships":x(a,["accountName"]);break;case"GetUserPinnedLinks":x(a,["accountName"]);break;case"GetUserProfileByGuid":x(a,["guid"]);break;case"GetUserProfileByIndex":x(a,["index"]);break;case"GetUserProfileByName":"undefined"!=typeof a.accountName&&a.accountName.length>0?x(a,[["AccountName","accountName"]]):x(a,["AccountName"]);break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetUserPropertyByAccountName":x(a,["accountName","propertyName"]);break;case"ModifyUserPropertyByAccountName":x(a,["accountName","newData"]);break;case"RemoveAllColleagues":x(a,["accountName"]);break;case"RemoveAllLinks":x(a,["accountName"]);break;case"RemoveAllMemberships":x(a,["accountName"]);break;case"RemoveAllPinnedLinks":x(a,["accountName"]);break;case"RemoveColleague":x(a,["accountName","colleagueAccountName"]);break;case"RemoveLink":x(a,["accountName","id"]);break;case"RemoveMembership":x(a,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":x(a,["accountName","id"]);break;case"UpdateColleaguePrivacy":x(a,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":x(a,["accountName","data"]);break;case"UpdateMembershipPrivacy":x(a,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":x(a,["accountName","data"]);break;case"DeleteAllVersions":x(a,["fileName"]);break;case"DeleteVersion":x(a,["fileName","fileVersion"]);break;case"GetVersions":x(a,["fileName"]);break;case"RestoreVersion":x(a,["fileName","fileVersion"]);break;case"AddView":x(a,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":x(a,["listName","viewName"]);break;case"GetView":x(a,["listName","viewName"]);break;case"GetViewCollection":x(a,["listName"]);break;case"GetViewHtml":x(a,["listName","viewName"]);break;case"UpdateView":x(a,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":x(a,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":x(a,["pageUrl","webPartXml","storage"]);break;case"AddWebPartToZone":x(a,["pageUrl","webPartXml","storage","zoneId","zoneIndex"]);break;case"DeleteWebPart":x(a,["pageUrl","storageKey","storage"]);break;case"GetWebPart2":x(a,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":x(a,["documentName","behavior"]);break;case"GetWebPartProperties":x(a,["pageUrl","storage"]);break;case"GetWebPartProperties2":x(a,["pageUrl","storage","behavior"]);break;case"SaveWebPart2":x(a,["pageUrl","storageKey","webPartXml","storage","allowTypeChange"]);break;case"Webs.CreateContentType":x(a,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":x(a,["webUrl"]);break;case"GetContentType":x(a,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":x(a,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":x(a,["objectUrl"]);break;case"GetWeb":x(a,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":x(a,["newFields","updateFields","deleteFields"]);break;case"Webs.UpdateContentType":x(a,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":x(a,[["pageUrl","pageURL"]]);break;case"AlterToDo":x(a,["item","todoId","todoListId","taskData"]);break;case"ClaimReleaseTask":x(a,["item","taskId","listId","fClaim"]);break;case"GetTemplatesForItem":x(a,["item"]);break;case"GetToDosForItem":x(a,["item"]);break;case"GetWorkflowDataForItem":x(a,["item"]);break;case"GetWorkflowTaskData":x(a,["item","listId","taskId"]);break;case"StartWorkflow":x(a,["item","templateId","workflowParameters"])}var n,l=we.header+we.opheader+we.payload+we.opfooter+we.footer;if(a.cacheXML&&(n=$[l]),"undefined"==typeof n){var c=e.ajax({url:i,async:a.async,beforeSend:function(e){Ne[a.operation][1]&&e.setRequestHeader("SOAPAction",ke)},type:"POST",data:l,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:function(t,r){e.isFunction(a.completefunc)&&a.completefunc(t,r)}});return a.cacheXML&&($[l]=c),c}return e.isFunction(a.completefunc)&&n.done(function(e,t,r){a.completefunc(r,t)}),n},e.fn.SPServices.defaults={cacheXML:!1,operation:"",webURL:"",makeViewDefault:!1,viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:!0,nonGregorian:!1,fClaim:!1,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:!1,isPrivate:!1,rating:1,maxResults:10,principalType:"User",async:!0,completefunc:null},e.fn.SPServices.SPGetCurrentSite=function(){if(ye.thisSite.length>0)return ye.thisSite;var t=we.header+"<WebUrlFromPageUrl xmlns='"+_+"/soap/' ><pageUrl>"+(location.href.indexOf("?")>0?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+we.footer;return e.ajax({async:!1,url:"/_vti_bin/Webs.asmx",type:"POST",data:t,dataType:"xml",contentType:'text/xml;charset="utf-8"',complete:function(t){ye.thisSite=e(t.responseXML).find("WebUrlFromPageUrlResult").text()}}),ye.thisSite},e.fn.SPServices.SPCascadeDropdowns=function(a){var r=e.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",relationshipListSortColumn:"",parentColumn:"",childColumn:"",listName:e().SPServices.SPListNameFromUrl(),CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns></QueryOptions>",promptText:"",noneText:"(None)",simpleChild:!1,selectSingleOption:!1,matchOnId:!1,completefunc:null,debug:!1},a),i=!1,o="SPServices.SPCascadeDropdowns",s=e().SPServices.SPDropdownCtl({displayName:r.parentColumn});if(null===s.Obj.html()&&r.debug)return void w(o,"parentColumn: "+r.parentColumn,E);var n=e().SPServices.SPDropdownCtl({displayName:r.childColumn});if(null===n.Obj.html()&&r.debug)return void w(o,"childColumn: "+r.childColumn,E);r.simpleChild===!0&&n.Type===H.complex&&(e().SPServices.SPComplexToSimpleDropdown({listName:r.listName,columnName:r.childColumn}),n=e().SPServices.SPDropdownCtl({displayName:r.childColumn}));var l,c;e().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:r.listName,completefunc:function(t){e(t.responseXML).find("Fields").each(function(){e(this).find("Field[DisplayName='"+r.childColumn+"']").each(function(){return l="TRUE"===e(this).attr("Required"),c=e(this).attr("StaticName"),!1})})}});var d={opt:r,childSelect:n,childColumnStatic:c,childColumnRequired:l},m=s.Obj.data("SPCascadeDropdownsChildColumns");if("undefined"==typeof m?s.Obj.data("SPCascadeDropdownsChildColumns",[d]):(m.push(d),s.Obj.data("SPCascadeDropdownsChildColumns",m),i=!0),!i)switch(s.Type){case H.simple:s.Obj.bind("change",function(){t(s)});break;case H.complex:s.optHid.bind("propertychange",function(){t(s)});break;case H.multiSelect:e(s.master.candidateControl).bind("dblclick",function(){t(s)}),e(s.master.resultControl).bind("dblclick",function(){t(s)}),e(s.master.addControl).bind("click",function(){t(s)}),e(s.master.removeControl).bind("click",function(){t(s)})}t(s)},e.fn.SPServices.SPComplexToSimpleDropdown=function(t){var a=e.extend({},{listName:e().SPServices.SPListNameFromUrl(),columnName:"",completefunc:null,debug:!1},t),r=e().SPServices.SPDropdownCtl({displayName:a.columnName});if(null===r.Obj.html()&&a.debug)return void w("SPServices.SPComplexToSimpleDropdown","columnName: "+a.columnName,E);if(r.Type===H.complex){var i=e(r.Obj).attr("choices").split("|"),o=r.optHid.val(),s=P("SPComplexToSimpleDropdown",r.Obj.attr("title"),a.listName),n="<select id='"+s+"' title='"+a.columnName+"'>";for(Ce=0;Ce<i.length;Ce+=2){var l=i[Ce+1]===o?" selected='selected' ":" ";n+="<option"+l+"value='"+i[Ce+1]+"'>"+i[Ce]+"</option>"}n+="</select>",r.Obj.closest("td").prepend(n);var c=e("#"+s);r.Obj.closest("span").find("img").remove(),r.Obj.closest("span").find("input").hide(),c.change(function(){var t=e(this).val();r.optHid.val(t),e(r.Obj).val(e(this).find("option[value='"+("0"!==t?t:"")+"']").html())}),c.trigger("change"),null!==a.completefunc&&a.completefunc()}},e.fn.SPServices.SPDisplayRelatedInfo=function(t){var r,i,o=e.extend({},{listName:e().SPServices.SPListNameFromUrl(),columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",matchOnId:!1,completefunc:null,debug:!1},t),s=[],n="SPServices.SPDisplayRelatedInfo",l=e().SPServices.SPDropdownCtl({displayName:o.columnName});if(null===l.Obj.html()&&o.debug)return void w(n,"columnName: "+o.columnName,E);switch(r=P("SPDisplayRelatedInfo",o.columnName,o.listName),e().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:o.relatedWebURL,listName:o.relatedList,completefunc:function(t){for(e(t.responseXML).find("faultcode").each(function(){o.debug&&w(n,"relatedList: "+o.relatedList,"List not found")}),i=e(t.responseXML).find("List"),Ce=0;Ce<o.relatedColumns.length;Ce++)s[o.relatedColumns[Ce]]=e(t.responseXML).find("Fields > Field[Name='"+o.relatedColumns[Ce]+"']");s[o.relatedListColumn]=e(t.responseXML).find("Fields > Field[Name='"+o.relatedListColumn+"']")}}),l.Type){case H.simple:l.Obj.bind("change",function(){a(o,r,i,s)});break;case H.complex:l.optHid.bind("propertychange",function(){a(o,r,i,s)});break;case H.multiSelect:o.debug&&w(n,"columnName: "+o.columnName,"Multi-select columns not supported by this function")}a(o,r,i,s)},e.fn.SPServices.SPFilterDropdown=function(t){var a,r,i=e.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListColumn:"",relationshipListSortColumn:"",relationshipListSortAscending:!0,columnName:"",listName:e().SPServices.SPListNameFromUrl(),promptText:"",noneText:"(None)",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns><ViewAttributes Scope='RecursiveAll'/></QueryOptions>",completefunc:null,debug:!1},t),o="",s=null,n="SPServices.SPFilterDropdown",l=e().SPServices.SPDropdownCtl({displayName:i.columnName});if(null===l.Obj.html()&&i.debug)return void w(n,"columnName: "+i.columnName,E);s=N(l,!0);var c=i.relationshipListSortColumn.length>0?i.relationshipListSortColumn:i.relationshipListColumn,d=i.relationshipListSortAscending===!0?"":"Ascending='FALSE'",m="<Query><OrderBy><FieldRef Name='"+c+"' "+d+"/></OrderBy><Where>";i.CAMLQuery.length>0&&(m+=i.CAMLQuery),m+="</Where></Query>",e().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:i.listName,completefunc:function(t){e(t.responseXML).find("Fields").each(function(){e(this).find("Field[DisplayName='"+i.columnName+"']").each(function(){return r="TRUE"===e(this).attr("Required"),!1})})}}),e().SPServices({operation:"GetListItems",async:!1,webURL:i.relationshipWebURL,listName:i.relationshipList,CAMLQuery:m,CAMLViewFields:"<ViewFields><FieldRef Name='"+i.relationshipListColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:i.CAMLQueryOptions,completefunc:function(t){switch(e(t.responseXML).find("errorstring").each(function(){var t=e(this).text();i.debug&&"One or more field types are not installed properly. Go to the list settings page to delete these fields."===t?w(n,"relationshipListColumn: "+i.relationshipListColumn,"Not found in relationshipList "+i.relationshipList):i.debug&&"Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."===t&&w(n,"relationshipList: "+i.relationshipList,"List not found")}),l.Type){case H.simple:e(l.Obj).find("option").remove(),!r&&i.promptText.length>0?l.Obj.append("<option value='0'>"+i.promptText.replace(/\{0\}/g,i.columnName)+"</option>"):r||l.Obj.append("<option value='0'>"+i.noneText+"</option>");break;case H.complex:o=r?"":i.noneText+"|0",l.Obj.val("");break;case H.multiSelect:e(l.master.candidateControl).find("option").remove(),a=""}switch(e(t.responseXML).SPFilterNode("z:row").each(function(){var t={},r=e(this).attr("ows_"+i.relationshipListColumn);switch("undefined"!=typeof r&&r.indexOf(X)>0?t=new V(r):(t.id=e(this).attr("ows_ID"),t.value=r),isNaN(t.id)&&(t.id=e(this).attr("ows_ID")),l.Type){case H.simple:var n=e(this).attr("ows_ID")===s[0]?" selected='selected'":"";l.Obj.append("<option"+n+" value='"+t.id+"'>"+t.value+"</option>");break;case H.complex:t.id===s[0]&&l.Obj.val(t.value),o=o+(o.length>0?"|":"")+t.value+"|"+t.id;break;case H.multiSelect:e(l.master.candidateControl).append("<option value='"+t.id+"'>"+t.value+"</option>"),a+=t.id+"|t"+t.value+"|t |t |t"}}),l.Type){case H.simple:l.Obj.trigger("change");break;case H.complex:l.Obj.attr("choices",o),l.Obj.trigger("propertychange");break;case H.multiSelect:l.master.data="",l.MultiLookupPickerdata.val(a),e(l.master.resultControl).find("option").each(function(){var t=e(this);e(this).attr("selected","selected"),e(l.master.candidateControl).find("option").each(function(){e(this).html()===t.html()&&t.removeAttr("selected")})}),GipRemoveSelectedItems(l.master),e(l.master.candidateControl).find("option").each(function(){var t=e(this);e(l.master.resultControl).find("option").each(function(){e(this).html()===t.html()&&t.remove()})}),GipAddSelectedItems(l.master),l.master.data=GipGetGroupData(a),e(l.master.candidateControl).trigger("dblclick")}}}),null!==i.completefunc&&i.completefunc()},e.fn.SPServices.SPDebugXMLHttpResult=function(t){var a,r=e.extend({},{node:null,indent:0},t),i=3,o=4,s="";if(s+="<table class='ms-vb' style='margin-left:"+3*r.indent+"px;' width='100%'>","DisplayPattern"===r.node.nodeName)s+="<tr><td width='100px' style='font-weight:bold;'>"+r.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+r.node.xml+"</textarea></td></tr>";else if(r.node.hasChildNodes())if(r.node.hasChildNodes()&&r.node.firstChild.nodeType===o)s+="<tr><td width='100px' style='font-weight:bold;'>"+r.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+r.node.parentNode.text+"</textarea></td></tr>";else if(r.node.hasChildNodes()&&r.node.firstChild.nodeType===i)s+="<tr><td width='100px' style='font-weight:bold;'>"+r.node.nodeName+"</td><td>"+I(r.node.firstChild.nodeValue)+"</td></tr>";else{for(s+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+r.node.nodeName+"</td></tr>",r.node.attributes&&(s+="<tr><td colspan='99'>"+L(r.node)+"</td></tr>"),s+="<tr><td>",a=0;a<r.node.childNodes.length;a++)s+=e().SPServices.SPDebugXMLHttpResult({node:r.node.childNodes.item(a),indent:r.indent+1});s+="</td></tr>"}else s+="<tr><td width='100px' style='font-weight:bold;'>"+r.node.nodeName+"</td><td>"+(null!==r.node.nodeValue?I(r.node.nodeValue):"&nbsp;")+"</td></tr>",r.node.attributes&&(s+="<tr><td colspan='99'>"+L(r.node)+"</td></tr>");return s+="</table>"},e.fn.SPServices.SPGetCurrentUser=function(t){var a=e.extend({},{webURL:"",fieldName:"Name",fieldNames:{},debug:!1},t);if("ID"===a.fieldName&&"undefined"!=typeof ye.thisUserId)return ye.thisUserId;var r,i="",o={},s=a.fieldNames.length>0?a.fieldNames.length:1,n=a.webURL.length>0?a.webURL:e().SPServices.SPGetCurrentSite();for(e.ajax({async:!1,url:("/"===n?"":n)+"/_layouts/userdisp.aspx?Force=True&"+(new Date).getTime(),complete:function(e){r=e}}),Ce=0;s>Ce;Ce++){if("ID"===a.fieldNames[Ce])i=ye.thisUserId;else{var l;l=s>1?RegExp('FieldInternalName="'+a.fieldNames[Ce]+'"',"gi"):RegExp('FieldInternalName="'+a.fieldName+'"',"gi"),e(r.responseText).find("table.ms-formtable td[id^='SPField']").each(function(){if(l.test(e(this).html())){switch(e(this).attr("id")){case"SPFieldText":i=e(this).text();break;case"SPFieldNote":i=e(this).find("div").html();break;case"SPFieldURL":i=e(this).find("img").attr("src");break;default:i=e(this).text()}return!1}})}"ID"!==a.fieldNames[Ce]&&(i="undefined"!=typeof i?i.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,""):null),s>1&&(o[a.fieldNames[Ce]]=i)}return s>1?o:i},e.fn.SPServices.SPLookupAddNew=function(t){var a=e.extend({},{lookupColumn:"",promptText:"Add new {0}",newWindow:!1,ContentTypeID:"",completefunc:null,debug:!1},t),r="SPServices.SPLookupAddNew",i=e().SPServices.SPDropdownCtl({displayName:a.lookupColumn});if(null===i.Obj.html()&&a.debug)return void w(r,"lookupColumn: "+a.lookupColumn,E);var o="",s="",n="";if(e().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:e().SPServices.SPListNameFromUrl(),completefunc:function(t){e(t.responseXML).find("Field[DisplayName='"+a.lookupColumn+"']").each(function(){return n=e(this).attr("StaticName"),e().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:e(this).attr("List"),completefunc:function(t){e(t.responseXML).find("List").each(function(){s=e(this).attr("WebFullUrl"),s=s!==j?s+j:s})}}),o=U(e(this).attr("List"),"NewForm"),!1})}}),0===s.length&&a.debug)return void w(r,"lookupColumn: "+a.lookupColumn,"This column does not appear to be a lookup column");if(o.length>0){var l=s+o;l+=a.newWindow?(a.ContentTypeID.length>0?"?ContentTypeID="+a.ContentTypeID:"")+"' target='_blank'":"?"+(a.ContentTypeID.length>0?"ContentTypeID="+a.ContentTypeID+"&":"")+"Source="+O(location.href)+"'";var c="<div id='SPLookupAddNew_"+n+"'><a href='"+l+">"+a.promptText.replace(/\{0\}/g,a.lookupColumn)+"</a></div>";e(i.Obj).parents("td.ms-formbody").append(c)}else if(a.debug)return void w(r,"lookupColumn: "+a.lookupColumn,"NewForm cannot be found");null!==a.completefunc&&a.completefunc()},e.fn.SPServices.SPGetLastItemId=function(t){var a,r=e.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},t),i=0;e().SPServices({operation:"GetUserInfo",webURL:r.webURL,async:!1,userLoginName:""!==r.userAccount?r.userAccount:e().SPServices.SPGetCurrentUser(),completefunc:function(t){e(t.responseXML).find("User").each(function(){a=e(this).attr("ID")})}});var o="<Query><Where>";return r.CAMLQuery.length>0&&(o+="<And>"),o+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+a+"</Value></Eq>",r.CAMLQuery.length>0&&(o+=r.CAMLQuery+"</And>"),o+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>",e().SPServices({operation:"GetListItems",async:!1,webURL:r.webURL,listName:r.listName,CAMLQuery:o,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(t){e(t.responseXML).SPFilterNode("z:row").each(function(){i=e(this).attr("ows_ID")})}}),i},e.fn.SPServices.SPRequireUnique=function(t){var a=e.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:!1,initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",showDupes:!1,completefunc:null},t),r=e().SPServices.SPGetQueryString(),i=r.ID;ye.thisList=e().SPServices.SPListNameFromUrl();var o="<span id='SPRequireUnique"+a.columnStaticName+"' class='{0}'>{1}</span><br/>",s=o.replace(/\{0\}/g,a.initMsgCSSClass).replace(/\{1\}/g,a.initMsg),n=e().SPServices.SPGetDisplayFromStatic({listName:ye.thisList,columnStaticName:a.columnStaticName}),l=G(n).find("input[Title^='"+n+"']");l.parent().append(s),l.blur(function(){var t=[],r=e(this).val();if(0===r.length)return!1;e().SPServices({operation:"GetListItems",async:!1,listName:ye.thisList,CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+a.columnStaticName+"'/></IsNotNull></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID' /><FieldRef Name='"+a.columnStaticName+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(o){var s=a.ignoreCase?r.toUpperCase():r;e(o.responseXML).SPFilterNode("z:row").each(function(){var r=a.ignoreCase?e(this).attr("ows_"+a.columnStaticName).toUpperCase():e(this).attr("ows_"+a.columnStaticName);s===r&&e(this).attr("ows_ID")!==i&&t.push([e(this).attr("ows_ID"),e(this).attr("ows_"+a.columnStaticName)])})}});var o=a.initMsg,s=e("#SPRequireUnique"+a.columnStaticName);if(s.html(o).attr("class",a.initMsgCSSClass),e("input[value='OK']:disabled, input[value='Save']:disabled").removeAttr("disabled"),t.length>0&&(o=a.errMsg,s.html(o).attr("class",a.errMsgCSSClass),1===a.duplicateAction&&(l.focus(),e("input[value='OK'], input[value='Save']").attr("disabled","disabled")),a.showDupes)){var n=" "+t.length+" duplicate item"+(t.length>1?"s":"")+": ";for(Ce=0;Ce<t.length;Ce++)n+="<a href='DispForm.aspx?ID="+t[Ce][0]+"&Source="+location.href+"'>"+t[Ce][1]+"</a> ";e("span#SPRequireUnique"+a.columnStaticName).append(n)}}),null!==a.completefunc&&a.completefunc()},e.fn.SPServices.SPGetDisplayFromStatic=function(t){var a=e.extend({},{webURL:"",listName:"",columnStaticName:"",columnStaticNames:{}},t),r="",i={},o=a.columnStaticNames.length>0?a.columnStaticNames.length:1;return e().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:a.webURL,listName:a.listName,completefunc:function(t){if(o>1)for(Ce=0;o>Ce;Ce++)i[a.columnStaticNames[Ce]]=e(t.responseXML).find("Field[StaticName='"+a.columnStaticNames[Ce]+"']").attr("DisplayName");else r=e(t.responseXML).find("Field[StaticName='"+a.columnStaticName+"']").attr("DisplayName")}}),o>1?i:r},e.fn.SPServices.SPGetStaticFromDisplay=function(t){var a=e.extend({},{webURL:"",listName:"",columnDisplayName:"",columnDisplayNames:{}},t),r="",i={},o=a.columnDisplayNames.length>0?a.columnDisplayNames.length:1;return e().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:a.webURL,listName:a.listName,completefunc:function(t){if(o>1)for(Ce=0;o>Ce;Ce++)i[a.columnDisplayNames[Ce]]=e(t.responseXML).find("Field[DisplayName='"+a.columnDisplayNames[Ce]+"']").attr("StaticName");else r=e(t.responseXML).find("Field[DisplayName='"+a.columnDisplayName+"']").attr("StaticName")}}),o>1?i:r},e.fn.SPServices.SPRedirectWithID=function(t){var a=e.extend({},{redirectUrl:"",qsParamName:"ID"},t);ye.thisList=e().SPServices.SPListNameFromUrl();var r=e().SPServices.SPGetQueryString(),i=r.ID,o=r.List,s=r.RootFolder,n=r.ContentTypeId;if("undefined"==typeof r.ID)i=e().SPServices.SPGetLastItemId({listName:ye.thisList}),e("form[id='aspnetForm']").each(function(){var e=location.href.indexOf("?")>0?location.href.substring(0,location.href.indexOf("?")):location.href,t="string"==typeof r.Source?"Source="+r.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"",a=[];"undefined"!=typeof o&&a.push("List="+o),"undefined"!=typeof s&&a.push("RootFolder="+s),"undefined"!=typeof n&&a.push("ContentTypeId="+n);var l=e+(a.length>0?"?"+a.join("&")+"&":"?")+"Source="+e+"?ID="+i+(t.length>0?"%26RealSource="+r.Source:"")+("string"==typeof r.RedirectURL?"%26RedirectURL="+r.RedirectURL:"");setTimeout(function(){document.forms.aspnetForm.action=l},0)});else{for(;r.ID===i;)i=e().SPServices.SPGetLastItemId({listName:ye.thisList});var l="string"==typeof r.RedirectURL?r.RedirectURL:a.redirectUrl;location.href=l+"?"+a.qsParamName+"="+i+("string"==typeof r.RealSource?"&Source="+r.RealSource:"")}},e.fn.SPServices.SPSetMultiSelectSizes=function(t){var a=e.extend({},{listName:e().SPServices.SPListNameFromUrl(),multiSelectColumn:"",minWidth:0,maxWidth:0,debug:!1},t),r="SPServices.SPSetMultiSelectSizes",i=e().SPServices.SPDropdownCtl({displayName:a.multiSelectColumn});if(null===i.Obj.html()&&a.debug)return void w(r,"multiSelectColumn: "+a.multiSelectColumn,E);if(i.Type!==H.multiSelect&&a.debug)return void w(r,"multiSelectColumn: "+a.multiSelectColumn,"Column is not multi-select.");var o=P("SPSetMultiSelectSizes",a.multiSelectColumn,a.listName),s=e("<select id='"+o+"' ></select>").appendTo(i.container);s.css({width:"auto",height:0,visibility:"hidden"}),e(i.master.candidateControl).find("option").each(function(){s.append("<option value='"+e(this).html()+"'>"+e(this).html()+"</option>")}),e(i.master.resultControl).find("option").each(function(){s.append("<option value='"+e(this).val()+"'>"+e(this).html()+"</option>")});var n=s.width()+5,l=n;(a.minWidth>0||a.maxWidth>0)&&(n<a.minWidth&&(n=a.minWidth),l<a.minWidth&&(l=a.minWidth),l>a.maxWidth&&(l=a.maxWidth));var c=n;e(i.master.candidateControl).css("width",c+"px").parent().css("width",l+"px"),e(i.master.resultControl).css("width",c+"px").parent().css("width",l+"px"),s.remove()},e.fn.SPServices.SPScriptAudit=function(t){var a,i=e.extend({},{webURL:"",listName:"",outputId:"",auditForms:!0,auditViews:!0,auditPages:!0,auditPagesListName:"Pages",showHiddenLists:!1,showNoScript:!1,showSrc:!0},t),o=[["New","NewForm.aspx",!1],["Display","DispForm.aspx",!1],["Edit","EditForm.aspx",!1]];e("#"+i.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>"+(i.showSrc?"<th>Script References</th>":"")+"</tr></table>");

var s=e("#SPScriptAudit");s.find("th").attr("class","ms-vh2-nofilter"),(i.auditForms||i.auditViews)&&e().SPServices({operation:"GetListCollection",webURL:i.webURL,async:!1,completefunc:function(t){e(t.responseXML).find("List").each(function(){a=e(this),(0===i.listName.length||a.attr("Title")===i.listName)&&(i.showHiddenLists&&"False"===a.attr("Hidden")||!i.showHiddenLists)&&(i.auditForms&&e().SPServices({operation:"GetListContentTypes",webURL:i.webURL,listName:a.attr("ID"),async:!1,completefunc:function(t){e(t.responseXML).find("ContentType").each(function(){if("0x0120"!==e(this).attr("ID").substring(0,6)){var t=e(this).find("FormUrls");for(Ce=0;Ce<o.length;Ce++)if(e(t).find(o[Ce][0]).each(function(){r(i,a,"Form",this.nodeName,(i.webURL.length>0?i.webURL:e().SPServices.SPGetCurrentSite())+j+e(this).text()),o[Ce][2]=!0}),!o[Ce][2]){var s=a.attr("DefaultViewUrl");r(i,a,"Form",o[Ce][0],s.substring(0,s.lastIndexOf(j)+1)+o[Ce][1])}for(Ce=0;Ce<o.length;Ce++)o[Ce][2]=!1}})}}),i.auditViews&&e().SPServices({operation:"GetViewCollection",webURL:i.webURL,listName:a.attr("ID"),async:!1,completefunc:function(t){e(t.responseXML).find("View").each(function(){r(i,a,"View",e(this).attr("DisplayName"),e(this).attr("Url"))})}}))})}});var n=0,l=[];if("string"==typeof i.auditPagesListName?(n=1,l.push(i.auditPagesListName)):(n=i.auditPagesListName.length,l=i.auditPagesListName),i.auditPages)for(Ce=0;n>Ce;Ce++)e().SPServices({operation:"GetList",async:!1,cacheXML:!0,webURL:i.webURL,listName:l[Ce],completefunc:function(t){e(t.responseXML).find("List").each(function(){a=e(this)})}}),e().SPServices({operation:"GetListItems",async:!1,webURL:i.webURL,listName:l[Ce],CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(t){e(t.responseXML).SPFilterNode("z:row").each(function(){var t=e(this).attr("ows_FileRef").split(X)[1],o=e(this).attr("ows_Title"),s="undefined"!=typeof o?o:"";t.indexOf(".aspx")>0&&r(i,a,"Page",s,j+t)})}});s.find("tr[class='ms-alternating']:even").removeAttr("class")},e.fn.SPServices.SPArrangeChoices=function(t){var a=e.extend({},{listName:e().SPServices.SPListNameFromUrl(),columnName:"",perRow:99,randomize:!1},t),r=!1,i=[],o=e().SPServices({operation:"GetList",async:!1,cacheXML:!0,listName:a.listName});o.done(function(){e(o.responseXML).find("Field[DisplayName='"+a.columnName+"']").each(function(){return r="TRUE"===e(this).attr("FillInChoice"),!1});var t,s,n=G(a.columnName),l=e(n).find("tr").length;e(n).find("tr").each(function(a){r&&a===l-2?t=e(this).find("td"):r&&a===l-1?s=e(this).find("td"):i.push(e(this).find("td"))}),a.randomize&&i.sort(F);var c=e("<table cellpadding='0' cellspacing='1'></table>");for(Ce=0;Ce<i.length;Ce++)(Ce+1)%a.perRow===0&&c.append("<tr></tr>"),c.find("tr:last").append(i[Ce]);if(r){var d=e("<tr><td colspan='99'><table cellpadding='0' cellspacing='1'><tr></tr></table></td></tr>");d.find("tr").append(t),d.find("tr").append(s),c.append(d)}var m=e(n).find("table:first");m.before(c),m.hide()})},e.fn.SPServices.SPAutocomplete=function(t){var a,r=e.extend({},{webURL:"",sourceList:"",sourceColumn:"",columnName:"",listName:e().SPServices.SPListNameFromUrl(),CAMLQuery:"",CAMLQueryOptions:"<QueryOptions></QueryOptions>",CAMLRowLimit:0,filterType:"BeginsWith",numChars:0,ignoreCase:!1,highlightClass:"",uniqueVals:!1,maxHeight:99999,slideDownSpeed:"fast",processingIndicator:"_layouts/images/REFRESH.GIF",debug:!1},t),i=G(r.columnName).find("input[Title^='"+r.columnName+"']");i.css("position","");var o=i.css("color"),s=i.css("width");if(null===i.html()&&r.debug)return void w("SPServices.SPAutocomplete","columnName: "+r.columnName,"Column is not an input control or is not found on page");i.closest("span").find("br").remove(),i.wrap("<div>");var n=P("SPAutocomplete",r.columnName,r.listName);i.after("<div><ul id='"+n+"' style='width:"+s+";display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'></div>");var l=e("#"+n);l.css("width",s),e(i).keyup(function(){var t=e(this).val();if(l.hide(),t.length<r.numChars)return!1;i.css({"background-image":"url("+r.processingIndicator+")","background-position":"right","background-repeat":"no-repeat"});var s=[],c="<Query><OrderBy><FieldRef Name='"+r.sourceColumn+"'/></OrderBy><Where>";r.CAMLQuery.length>0&&(c+="<And>"),c+="<"+r.filterType+"><FieldRef Name='"+r.sourceColumn+"'/><Value Type='Text'>"+t+"</Value></"+r.filterType+">",r.CAMLQuery.length>0&&(c+=r.CAMLQuery+"</And>"),c+="</Where></Query>",e().SPServices({operation:"GetListItems",async:!1,webURL:r.WebURL,listName:r.sourceList,CAMLQuery:c,CAMLQueryOptions:r.CAMLQueryOptions,CAMLViewFields:"<ViewFields><FieldRef Name='"+r.sourceColumn+"' /></ViewFields>",CAMLRowLimit:r.CAMLRowLimit,completefunc:function(a){var i=r.ignoreCase?t.toUpperCase():t;e(a.responseXML).SPFilterNode("z:row").each(function(){var t=e(this).attr("ows_"+r.sourceColumn),a=r.ignoreCase?e(this).attr("ows_"+r.sourceColumn).toUpperCase():e(this).attr("ows_"+r.sourceColumn);if("Contains"===r.filterType){var o=a.indexOf(i);o>=0&&(!r.uniqueVals||-1===e.inArray(t,s))&&s.push(e(this).attr("ows_"+r.sourceColumn))}else i!==a.substr(0,i.length)||r.uniqueVals&&-1!==e.inArray(t,s)||s.push(e(this).attr("ows_"+r.sourceColumn))})}});var d="";for(Ce=0;Ce<s.length;Ce++){if(r.highlightClass.length>0){var m=new RegExp(t,r.ignoreCase?"gi":"g"),u=s[Ce].match(m),p=0;for(a=0;a<u.length;a++){var h=s[Ce].indexOf(u[a],p),f=h+u[a].length,b="<span class='"+r.highlightClass+"'>"+u[a]+"</span>";s[Ce]=s[Ce].substr(0,h)+b+s[Ce].substr(f),p=h+b.length}}d+="<li style='display: block;position: relative;cursor: pointer;'>"+s[Ce]+"</li>"}l.html(d),e("#"+n+" li").click(function(){e("#"+n).fadeOut(r.slideUpSpeed),i.val(e(this).text())}).mouseover(function(){var t={cursor:"hand",color:"#ffffff",background:"#3399ff"};e(this).css(t)}).mouseout(function(){var t={cursor:"inherit",color:o,background:"transparent"};e(this).css(t)}),s.length>0&&e("#"+n).slideDown(r.slideDownSpeed),i.css("background-image","")})},e.fn.SPServices.SPGetQueryString=function(t){for(var a=e.extend({},{lowercase:!1},t),r={},i=location.search.slice(1).split("&"),o=0;o<i.length;o++){var s=i[o].split("="),n=a.lowercase?s[0].toLowerCase():s[0];r[n]=decodeURIComponent(s[1]||"")}return r},e.fn.SPServices.SPListNameFromUrl=function(t){var a=e.extend({},{listName:""},t);if(a.listName.length>0)return ye.thisList=a.listName,ye.thisList;if(void 0!==ye.thisList&&ye.thisList.length>0)return ye.thisList;var r=location.href,i=r.substring(0,r.indexOf(".aspx")),o=decodeURIComponent(i.substring(0,i.lastIndexOf(j)+1)).toUpperCase();return e().SPServices({operation:"GetListCollection",async:!1,completefunc:function(t){e(t.responseXML).find("List").each(function(){var t=e(this).attr("DefaultViewUrl"),a=t.substring(0,t.lastIndexOf(j)+1).toUpperCase();return o.indexOf(a)>0?(ye.thisList=e(this).attr("ID"),!1):void 0})}}),ye.thisList},e.fn.SPServices.SPUpdateMultipleListItems=function(t){var a,r=e.extend({},{webURL:"",listName:"",CAMLQuery:"",batchCmd:"Update",valuepairs:[],completefunc:null,debug:!1},t),i=[],o=[];e().SPServices({operation:"GetListItems",async:!1,webURL:r.webURL,listName:r.listName,CAMLQuery:r.CAMLQuery,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(t){e(t.responseXML).SPFilterNode("z:row").each(function(){i.push(e(this).attr("ows_ID"));var t=e(this).attr("ows_FileRef");t="/"+t.substring(t.indexOf(X)+2),o.push(t)})}});var s,n="<Batch OnError='Continue'>";for(a=0;a<i.length;a++){for(n+="<Method ID='"+a+"' Cmd='"+r.batchCmd+"'>",s=0;s<r.valuepairs.length;s++)n+="<Field Name='"+r.valuepairs[s][0]+"'>"+M(r.valuepairs[s][1])+"</Field>";n+="<Field Name='ID'>"+i[a]+"</Field>",o[a].length>0&&(n+="<Field Name='FileRef'>"+o[a]+"</Field>"),n+="</Method>"}n+="</Batch>",e().SPServices({operation:"UpdateListItems",async:!1,webURL:r.webURL,listName:r.listName,updates:n,completefunc:function(e){null!==r.completefunc&&r.completefunc(e)}})},e.fn.SPServices.SPGetListItemsJson=function(t){var a,r=e.extend({},{webURL:"",listName:"",viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:"",CAMLQueryOptions:"",changeToken:"",contains:"",mapping:null,mappingOverrides:null,debug:!1},e().SPServices.defaults,t),i={},o=[],s=e.Deferred(),n=e().SPServices({operation:"GetListItemChangesSinceToken",webURL:r.webURL,listName:r.listName,viewName:r.viewName,CAMLQuery:r.CAMLQuery,CAMLViewFields:r.CAMLViewFields,CAMLRowLimit:r.CAMLRowLimit,CAMLQueryOptions:r.CAMLQueryOptions,changeToken:r.changeToken,contains:r.contains});return n.done(function(){var t="SPGetListItemsJson"+r.webURL+r.listName,l=e(n.responseXML);if(a=l.find("Changes").attr("LastChangeToken"),l.find("listitems Changes Id[ChangeType='Delete']").each(function(){o.push(e(this).text())}),null===r.mapping?l.find("List > Fields > Field").each(function(){var t=e(this),a=t.attr("Type");e.inArray(a,z)>=0&&(i["ows_"+t.attr("Name")]={mappedName:t.attr("Name"),objectType:t.attr("Type")})}):i=r.mapping,null!==r.mappingOverrides)for(var c in r.mappingOverrides)i[c]=r.mappingOverrides[c];e.isEmptyObject(i)?i=e(document).data(t):e(document).data(t,i);var d=l.SPFilterNode("z:row").SPXmlToJson({mapping:i,sparse:!0}),m={changeToken:a,mapping:i,data:d,deletedIds:o};s.resolveWith(m)}),s.promise()},e.fn.SPServices.SPConvertDateToISO=function(t){var a=e.extend({},{dateToConvert:new Date,dateOffset:"-05:00"},t),r="",i=a.dateToConvert;return r+=i.getFullYear()+"-",r+=W(i.getMonth()+1)+"-",r+=W(i.getDate()),r+="T"+W(i.getHours())+":",r+=W(i.getMinutes())+":",r+=W(i.getSeconds())+"Z"+a.dateOffset},e.fn.SPFilterNode=function(e){return this.find("*").filter(function(){return this.nodeName===e})},e.fn.SPXmlToJson=function(t){var a,r=e.extend({},{mapping:{},includeAllAttrs:!1,removeOws:!0,sparse:!1},t),i=[];return this.each(function(){var t={},o=this.attributes;for(r.sparse||e.each(r.mapping,function(){t[this.mappedName]=""}),a=0;a<o.length;a++){var n=o[a].name,l=r.mapping[n],c="undefined"!=typeof l?l.mappedName:r.removeOws?n.split("ows_")[1]:n,d="undefined"!=typeof l?l.objectType:void 0;(r.includeAllAttrs||void 0!==l)&&(t[c]=s(o[a].value,d))}i.push(t)}),i},e.fn.SPServices.SPFindPeoplePicker=function(t){var a=e.extend({},{peoplePickerDisplayName:"",valueToSet:"",checkNames:!0},t),r=e("nobr").filter(function(){return e(this).contents().eq(0).text()===a.peoplePickerDisplayName}).closest("tr"),i=r.find("div[name='upLevelDiv']"),o=r.find("img[Title='Check Names']:first");a.valueToSet.length>0&&i.html(a.valueToSet),a.checkNames&&o.click();var s=e.trim(i.text()),n=[];return i.children("span").each(function(){var t=e(this).find("div[data]").attr("data"),a={};if("undefined"!=typeof t){var r=e.parseXML(t),i=e(r);i.find("DictionaryEntry").each(function(){var t=e(this).find("Key").text();a[t]=e(this).find("Value").text()}),n.push(a)}else e().SPServices({operation:"GetUserInfo",async:!1,cacheXML:!0,userLoginName:e(this).attr("title"),completefunc:function(t){e(t.responseXML).find("User").each(function(){e.each(this.attributes,function(e,t){a[t.name]=t.value}),n.push(a)})}})}),{row:r,contents:i,currentValue:s,checkNames:o,dictionaryEntries:n}},e.fn.SPFindPeoplePicker=function(t){return e().SPServices.SPFindPeoplePicker(t)},e.fn.SPServices.SPFindMMSPicker=function(t){for(var a=e.extend({},{MMSDisplayName:""},t),r=[],i=e("div[title='"+a.MMSDisplayName+"']"),o=i.closest("td").find("input[type='hidden']"),s=o.val().split(";"),n=0;n<s.length;n++){var l=s[n].split("|");r.push({value:l[0],guid:l[1]})}return{terms:r}},e.fn.SPServices.Version=function(){return Q},e.fn.SPServices.SPDropdownCtl=function(t){var a=e.extend({},{displayName:""},t),r={},i=e().SPServices.SPGetStaticFromDisplay({listName:e().SPServices.SPListNameFromUrl(),columnDisplayName:a.displayName});if(r.Type=1===(r.Obj=e("select[Title='"+a.displayName+"']")).length?H.simple:1===(r.Obj=e("input[Title='"+a.displayName+"']")).length?H.complex:1===(r.Obj=e("select:regex(id, ("+i+")(_)[0-9a-fA-F]{8}(-))")).length?H.simple:1===(r.Obj=e("select[ID$='SelectCandidate'][Title^='"+a.displayName+" ']")).length?H.multiSelect:1===(r.Obj=e("select[ID$='SelectCandidate'][Title$=': "+a.displayName+"']")).length?H.multiSelect:1===(r.Obj=e("select[ID$='SelectCandidate'][Title$='\""+a.displayName+"\".']")).length?H.multiSelect:1===(r.Obj=e("select[ID$='SelectCandidate'][Title$=' "+a.displayName+"']")).length?H.multiSelect:null,null===r.Type){var o=G(a.displayName);if(void 0!==o){var s=o.find("select[title^='"+a.displayName+" '][id$='_Lookup']");s&&1===s.length&&(r.Type=H.simple,r.Obj=s)}}if(r.Type===H.complex)r.optHid=e("input[id='"+r.Obj.attr("optHid")+"']");else if(r.Type===H.multiSelect){r.container=r.Obj.closest("span"),r.MultiLookupPickerdata=r.container.find("input[id$='"+q+"_data'], input[id$='"+B+"_data']");var n=r.container.find("[id$='AddButton']").attr("id");r.master=window[n.replace(/AddButton/,q+"_m")]||window[n.replace(/AddButton/,B+"_m")]}return r};var Pe={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};e.expr[":"].regex=function(t,a,r){var i=r[3].split(","),o=/^(data|css):/,s={method:i[0].match(o)?i[0].split(":")[0]:"attr",property:i.shift().replace(o,"")},n="ig",l=new RegExp(i.join("").replace(/^\s+|\s+$/g,""),n);return l.test(e(t)[s.method](s.property))}}(jQuery),function(){"use strict";function e(t){if(!(this instanceof e))throw"the form js must be constructed with new.";if(!$().SPServices)throw' the dependance "SP services" was not found! please download the latest (https://spservices.codeplex.com) and load it before this file.';if(!$().validate)throw'the dependance "jquery validatation" was not found! please download the latest (http://jqueryvalidation.org) and load it before this file.';this.applyOptions(t),this.initGreCaptcha(this.init)}var t={overlay:null,submit:null,form:null,formList:"",domainURL:"",validateOptions:null,successEl:null,countryDropdown:null,stateDropdown:null,usStatesData:null},a=null,r=console?console.warn.bind(console)||console.log.bind(console):function(e){return e};if(e.prototype.init=function(){var e=this;this.resizeIframe(),this.getList("http://givenimaging.com","Countries",!1,function(){e.createCountryStateOptions.apply(e,arguments),this.getList("http://givenimaging.com","US States",!1,function(){r("this = ",e),t.usStatesData=e.createCountryStateOptions.apply(e,arguments),e.initEvents()})},[t.countryDropdown]),this.createValidator()},e.prototype.applyOptions=function(e){for(var a in e)a in t&&(t[a]=e[a])},e.prototype.initEvents=function(){var e=this;t.submit.on("mouseup",function(){e.submitForm()}),t.countryDropdown.on("change",function(){if($(this).val().search(/united states/gi)>-1){var e=t.usStatesData.cloneNode(!0);t.stateDropdown.rules("add","required"),t.stateDropdown.append(e),t.stateDropdown.parents(".row").removeClass("hide")}else t.stateDropdown.parents(".row").addClass("hide"),t.stateDropdown.rules("remove","required"),t.stateDropdown.empty()})},e.prototype.createValidator=function(){if(!t.validateOptions)throw"No options for validatation provided.";if(0===t.form.length)throw"No form selector provided.";t.form.validate(t.validateOptions),console.log(t.form)},e.prototype.getList=function(e,t,a,r,i){var o=this;this.loadStart();var s=$().SPServices.SPGetListItemsJson({webURL:e,listName:t,viewName:"",CAMLQuery:a||"",CAMLViewFields:"",CAMLRowLimit:"",CAMLQueryOptions:"",changeToken:"",contains:"",mapping:null,mappingOverrides:null,debug:!1});$.when(s).done(function(){r&&"function"==typeof r&&(i&&i instanceof Array?(i.splice(0,0,this.data,t),r.apply(o,i)):r(this.data,t)),o.loadDone()})},e.prototype.CreateNewItem=function(e,t,a,r,i){var o=this;this.loadStart(),$().SPServices({webURL:e,operation:"UpdateListItems",async:!1,batchCmd:"New",listName:a,valuepairs:t,completefunc:function(e,t){r&&"function"==typeof r&&r(),console.log(e,t),o.loadDone()}})},e.prototype.submitForm=function(){var e=t.form.valid(),a=this.createValuePairs($(".formElement"));e&&this.CreateNewItem(t.domainURL,a,t.formList,this.showSuccessMessage)},e.prototype.showSuccessMessage=function(){t.form.fadeOut(100,function(){t.successEl.fadeIn()})},e.prototype.resizeIframe=function(){var e=parent.document.getElementById(window.name);if(e){var t=document,a=Math.max(Math.max(t.body.scrollHeight,t.documentElement.scrollHeight),Math.max(t.body.offsetHeight,t.documentElement.offsetHeight),Math.max(t.body.clientHeight,t.documentElement.clientHeight));e.style.height=a+100+"px"}else r("No IFRAME detected, skipping resizing...")},e.prototype.initGreCaptcha=function(){var e=this;window.onloadCallback=function(){e.init(),a=grecaptcha}},e.prototype.loadStart=function(){t.overlay.show()},e.prototype.loadDone=function(){t.overlay.hide()},e.prototype.createValuePairs=function(e){for(var t=[],a=e.length-1;a>=0;a--)e[a].value&&t.push([e[a].name,e[a].value]);return t},e.prototype.createCountryStateOptions=function(e,t,a){var r=document.createDocumentFragment(),i=null,o=t.toLowerCase();if(e.length){e.reverse();for(var s=e.length-1;s>=0;s--)i=document.createElement("option"),"countries"===o?i.innerHTML=e[s].Title:"us states"===o&&(i.innerHTML=e[s].abbreviation),r.appendChild(i);if(!a)return r;a.html(r)}},window.formjs){if(window.formjs&&window.formjs!==e)return r('Cannot assign "formConstructor" to the property formjs on the window object because it already is assigned a value.'),!1}else window.formjs=e}();